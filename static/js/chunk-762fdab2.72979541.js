(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-762fdab2"],{"5a2b":function(e,t,n){"use strict";n.r(t);n("a9e3");var a=n("7a23"),r=n("ce00"),c=n.n(r),o=n("f5be"),s=n.n(o),i=n("2602"),u=n.n(i),l=Object(a["W"])("data-v-e781c876");Object(a["F"])("data-v-e781c876");var d={class:"page-box index-box"},b={class:"swap-box"},m={class:"swap"},p={class:"swap-input"},f={class:"title flex-between"},O={class:"text"},v=Object(a["l"])("输入"),j={class:"balance"},w=Object(a["m"])("div",{class:"flex-middle right-box"},[Object(a["m"])("img",{src:c.a,alt:""}),Object(a["m"])("span",null,"ABDX")],-1),x=Object(a["m"])("div",{class:"swap-icon"},[Object(a["m"])("img",{src:s.a,alt:""})],-1),h={class:"swap-input"},g=Object(a["m"])("div",{class:"title flex-between"},[Object(a["m"])("div",{class:"text"},"输出")],-1),C=Object(a["m"])("div",{class:"flex-middle right-box"},[Object(a["m"])("img",{src:u.a,alt:""}),Object(a["m"])("span",null,"USDT")],-1),k={class:"price-box"},y=Object(a["l"])("兑换"),A=Object(a["l"])("授权"),R=Object(a["m"])("div",{class:"rule-box"},[Object(a["m"])("div",{class:"title"},"兑换规则"),Object(a["m"])("div",{class:"content"}," 1、100ABDX可以兑换1USDT ")],-1);Object(a["D"])();var B=l((function(e,t,n,r,c,o){var s=Object(a["J"])("HeadTop"),i=Object(a["J"])("van-field"),u=Object(a["J"])("van-button");return Object(a["C"])(),Object(a["h"])("div",d,[Object(a["m"])(s,{title:"兑换"}),Object(a["m"])("div",b,[Object(a["m"])("div",m,[Object(a["m"])("div",p,[Object(a["m"])("div",f,[Object(a["m"])("div",O,[v,Object(a["m"])("span",{class:"total-stake",onClick:t[1]||(t[1]=function(){return e.getTotalBlance&&e.getTotalBlance.apply(e,arguments)})},"全部兑换")]),Object(a["m"])("div",j,"余额: "+Object(a["N"])(e.balance),1)]),Object(a["m"])(i,{modelValue:e.amount,"onUpdate:modelValue":[t[2]||(t[2]=function(t){return e.amount=t}),e.getOutAmount],type:"number",label:"",placeholder:"0.0"},{button:l((function(){return[w]})),_:1},8,["modelValue","onUpdate:modelValue"])]),x,Object(a["m"])("div",h,[g,Object(a["m"])(i,{modelValue:e.usdtAmount,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.usdtAmount=t}),label:"",readonly:"",placeholder:"0.0"},{button:l((function(){return[C]})),_:1},8,["modelValue"])]),Object(a["m"])("div",k,Object(a["N"])(e.rate)+" ABDX : 1 USDT",1),Number(e.allowance)>0?(Object(a["C"])(),Object(a["h"])(u,{key:0,type:"primary",loading:e.btn.loading,size:"large","loading-text":"正在兑换...",onClick:e.swap},{default:l((function(){return[y]})),_:1},8,["loading","onClick"])):(Object(a["C"])(),Object(a["h"])(u,{key:1,type:"primary",loading:e.btn.loading,size:"large","loading-text":"正在授权...",onClick:e.approve},{default:l((function(){return[A]})),_:1},8,["loading","onClick"]))])]),R])})),D=n("5530"),U=n("1da1"),N=(n("96cf"),n("b680"),n("1a2e")),T=n("47e2"),F=n("5502"),I=n("01ea"),V=n("722f"),_=n("440b"),J=n("9d56"),M=n("626a"),S=n("6c02"),E=n("901e"),X=n.n(E),z=n("2ef0"),H=n.n(z),G={components:{HeadTop:N["a"]},setup:function(){var e=Object(F["b"])(),t=Object(T["b"])(),n=t.t,r=Object(S["e"])(),c=Object(a["G"])({$t:n,address:Object(a["f"])((function(){return e.state.accounts[0]})),web3:Object(a["f"])((function(){return e.state.provider})),investContract:null,abdxContract:null,usdtContract:null,userInfo:{intro:"",isExist:!0},btn:{loading:!1},amount:"",incomeAmount:Object(a["f"])((function(){return c.amount?Number(3.6*c.amount).toFixed(2):""})),allowance:"",balance:"",rate:"100",staticAmount:"0.00",usdtAmount:"",initContract:function(){c.investContract=new c.web3.eth.Contract(_,I["a"].investAddress),c.abdxContract=new c.web3.eth.Contract(V,I["a"].abdxAddress),c.usdtContract=new c.web3.eth.Contract(V,I["a"].usdtAddress),c.initData()},initData:function(){c.getUserInfo(),c.getRate(),c.getBalance(),c.getAllowance()},getUserInfo:function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c.investContract.methods.getUserInfo(c.address).call();case 2:t=e.sent,c.userInfo.intro=t.intro,c.userInfo.isExist=t.isExist;case 5:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),getRate:function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c.investContract.methods.tokenPrice().call();case 2:t=e.sent,c.rate=new X.a(t).dividedBy(1e4).toFixed();case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),getAllowance:function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c.abdxContract.methods.allowance(c.address,I["a"].investAddress).call();case 2:t=e.sent,c.allowance=t;case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),getBalance:function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c.abdxContract.methods.decimals().call();case 2:return t=e.sent,e.next=5,c.abdxContract.methods.balanceOf(c.address).call();case 5:n=e.sent,c.balance=new X.a(n).dividedBy(Math.pow(10,t)).toFixed(6);case 7:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),getTotalBlance:function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c.abdxContract.methods.decimals().call();case 2:return t=e.sent,e.next=5,c.abdxContract.methods.balanceOf(c.address).call();case 5:n=e.sent,c.amount=new X.a(n).dividedBy(Math.pow(10,t)).toFixed(Number(t)),c.getOutAmount();case 8:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),getOutAmount:H.a.throttle(Object(U["a"])(regeneratorRuntime.mark((function e(){var t,n,a,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(c.amount&&0!=Number(c.amount)){e.next=2;break}return e.abrupt("return","0.00");case 2:return e.next=4,c.abdxContract.methods.decimals().call();case 4:return t=e.sent,n=new X.a(c.amount).multipliedBy(Math.pow(10,t)).toFixed(),e.next=8,c.investContract.methods.getUsdtAmount(n).call();case 8:return a=e.sent,e.next=11,c.usdtContract.methods.decimals().call();case 11:r=e.sent,o=new X.a(a).dividedBy(Math.pow(10,r)).toFixed(6),c.usdtAmount=o;case 14:case"end":return e.stop()}}),e)}))),1e3),approve:function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return c.btn.loading=!0,e.prev=1,e.next=4,c.abdxContract.methods.approve(I["a"].investAddress,J["a"]).send({from:c.address});case 4:Object(M["a"])("授权成功"),c.getAllowance(),c.btn.loading=!1,e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](1),Object(M["a"])("授权失败"),c.btn.loading=!1;case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));function t(){return e.apply(this,arguments)}return t}(),swap:function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(c.amount){e.next=3;break}return Object(M["a"])("请先输入数量"),e.abrupt("return");case 3:if(!(Number(c.amount)>Number(c.balance))){e.next=6;break}return Object(M["a"])("余额不足"),e.abrupt("return");case 6:if(!(Number(c.amount)<1e3)){e.next=9;break}return Object(M["a"])("数量需要大于1000"),e.abrupt("return");case 9:return c.btn.loading=!0,e.prev=10,e.next=13,c.abdxContract.methods.decimals().call();case 13:return t=e.sent,n=new X.a(c.amount).multipliedBy(Math.pow(10,t)).toFixed(),e.next=17,c.investContract.methods.swapByToken(n).send({from:c.address});case 17:c.initData(),Object(M["a"])("兑换成功"),c.btn.loading=!1,r.push({name:"RecordSwap"}),e.next=27;break;case 23:e.prev=23,e.t0=e["catch"](10),Object(M["a"])("兑换失败"),c.btn.loading=!1;case 27:case"end":return e.stop()}}),e,null,[[10,23]])})));function t(){return e.apply(this,arguments)}return t}()});c.address&&c.initContract(),Object(a["S"])((function(){return c.address}),(function(e){e&&c.initContract()}));var o=Object(a["O"])(c);return Object(D["a"])({},o)}};n("f5b1");G.render=B,G.__scopeId="data-v-e781c876";t["default"]=G},e1d4:function(e,t,n){},f5b1:function(e,t,n){"use strict";n("e1d4")}}]);
//# sourceMappingURL=chunk-762fdab2.72979541.js.map