{"version":3,"sources":["webpack:///./src/views/record/invest/index.vue?e4ba","webpack:///./src/views/record/invest/index.vue","webpack:///./src/views/record/invest/List.vue","webpack:///./src/views/record/invest/List.vue?0a7c","webpack:///./src/views/record/invest/index.vue?a6e8","webpack:///./src/views/record/invest/List.vue?b025"],"names":["class","title","refreshing","onRefresh","loading","immediate-check","error","error-text","finished","finished-text","onLoad","list","item","key","id","user","Number","amount","tokenDecimls","toFixed","backAmount","$dateformat","time","props","type","Array","default","setup","store","t","data","$t","web3","state","provider","address","accounts","abdxContract","initContract","eth","Contract","config","abdxAddress","methods","decimals","call","val","refData","render","__scopeId","components","HeadTop","List","investContract","page","limit","investAbi","investAddress","initData","getInvestLog","then","result","push","Math","ceil","total","catch"],"mappings":"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","file":"static/js/chunk-5ada2149.05cf721b.js","sourcesContent":["export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./index.vue?vue&type=style&index=0&id=d36c7740&lang=less&scoped=true\"","<template>\r\n  <div class=\"page-box\">\r\n    <HeadTop title=\"投资记录\"></HeadTop>\r\n    <div class=\"invest\">\r\n      <van-pull-refresh v-model=\"refreshing\" @refresh=\"onRefresh\">\r\n        <van-list v-model:loading=\"loading\" :immediate-check=\"false\" v-model:error=\"error\" error-text=\"请求失败，点击重新加载\" :finished=\"finished\" finished-text=\"没有更多了\" @load=\"onLoad\">\r\n          <div class=\"list-wrap\">\r\n            <List :list=\"list\"></List>\r\n          </div>\r\n        </van-list>\r\n      </van-pull-refresh>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport HeadTop from '@/components/HeadTop'\r\nimport List from './List'\r\nimport { reactive, toRefs, computed, watch } from \"vue\";\r\nimport { useI18n } from \"vue-i18n\";\r\nimport { useStore } from \"vuex\";\r\nimport config from \"@/utils/config\";\r\nimport tokenAbi from \"@/utils/abi\";\r\nimport investAbi from \"@/utils/investAbi\";\r\nimport { getInvestLog } from \"@/api\";\r\nexport default {\r\n  components: {\r\n    HeadTop,\r\n    List\r\n  },\r\n  setup () {\r\n    const store = useStore()\r\n    const { t } = useI18n()\r\n    const data = reactive({\r\n      $t: t,\r\n      address: computed(() => store.state.accounts[0]),\r\n      web3: computed(() => store.state.provider),\r\n      investContract: null,\r\n      abdxContract: null,\r\n      tokenDecimls: 0,\r\n      list: [],\r\n      page: 1,\r\n      limit: 5,\r\n      loading: false,\r\n      error: false,\r\n      finished: false,\r\n      refreshing: false,\r\n      initContract: async () => {\r\n        data.investContract = new data.web3.eth.Contract(investAbi, config.investAddress)\r\n        data.abdxContract = new data.web3.eth.Contract(tokenAbi, config.abdxAddress)\r\n        data.tokenDecimls = await data.abdxContract.methods.decimals().call()\r\n        data.initData()\r\n      },\r\n      initData: () => {\r\n        console.log('initData')\r\n        data.page = 1\r\n        data.getInvestLog()\r\n      },\r\n      getInvestLog () {\r\n        console.log(data.page, data.limit)\r\n        getInvestLog({ address: data.address, page: data.page, limit: data.limit }).then((result) => {\r\n          if (data.refreshing) {\r\n            data.list = [];\r\n            data.refreshing = false;\r\n          }\r\n          if (data.page === 1) {\r\n            data.list = result.data.list\r\n          } else {\r\n            data.list.push(...result.data.list)\r\n          }\r\n          data.loading = false\r\n          data.finished = !(Math.ceil(result.data.total / data.limit) > data.page)\r\n        })\r\n          .catch(() => {\r\n            data.error = true\r\n          })\r\n      },\r\n      onLoad () {\r\n        console.log('onLoad')\r\n        data.page++\r\n        data.getInvestLog()\r\n      },\r\n      onRefresh () {\r\n        data.finished = false;\r\n        // 重新加载数据\r\n        // 将 loading 设置为 true，表示处于加载状态\r\n        data.loading = true;\r\n        data.page = 1\r\n        data.getInvestLog()\r\n      }\r\n    })\r\n    if (data.address) {\r\n      data.initContract()\r\n    }\r\n    watch(() => data.address, (val) => {\r\n      if (val) {\r\n        data.initContract()\r\n      }\r\n    })\r\n    const refData = toRefs(data);\r\n    return {\r\n      ...refData\r\n    };\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.invest {\r\n  padding: 12px 15px;\r\n  min-height: calc(100vh - 46px);\r\n  .van-pull-refresh {\r\n    height: 100%;\r\n  }\r\n}\r\n</style>\r\n<style lang=\"less\">\r\n</style>\r\n","<template>\r\n  <div class=\"ul\" v-for=\"item in list\" :key=\"item.id\">\r\n    <div class=\"li\">\r\n      <div class=\"value\"><span class=\"key\">质押地址：</span>{{item.user}}</div>\r\n    </div>\r\n    <div class=\"li\">\r\n      <div class=\"value\"><span class=\"key\">质押数量 (ABDX)：</span>{{Number(item.amount/10**tokenDecimls).toFixed(6)}}</div>\r\n    </div>\r\n    <div class=\"li\">\r\n      <div class=\"value\"><span class=\"key\">质押收益 (ABDX)：</span>{{Number(item.backAmount/10**tokenDecimls).toFixed(6)}}</div>\r\n    </div>\r\n    <div class=\"li\">\r\n      <div class=\"value\"><span class=\"key\">质押时间：</span>{{$dateformat(item.time*1000, 'yyyy-mm-dd HH:MM:ss')}}</div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { reactive, toRefs, computed, watch } from \"vue\";\r\nimport { useI18n } from \"vue-i18n\";\r\nimport config from \"@/utils/config\";\r\nimport tokenAbi from \"@/utils/abi\";\r\nimport { useStore } from \"vuex\";\r\nexport default {\r\n  props: {\r\n    list: {\r\n      type: Array,\r\n      default: () => {\r\n        return []\r\n      }\r\n    }\r\n  },\r\n  setup (props) {\r\n    const store = useStore()\r\n    const { t } = useI18n()\r\n    console.log(props)\r\n    const data = reactive({\r\n      $t: t,\r\n      web3: computed(() => store.state.provider),\r\n      address: computed(() => store.state.accounts[0]),\r\n      abdxContract: null,\r\n      tokenDecimls: 10 ** 18,\r\n      list: [],\r\n      initContract: async () => {\r\n        data.abdxContract = new data.web3.eth.Contract(tokenAbi, config.abdxAddress)\r\n        data.tokenDecimls = await data.abdxContract.methods.decimals().call()\r\n        data.list = props.list\r\n      }\r\n    })\r\n    if (data.address) {\r\n      data.initContract()\r\n    }\r\n    watch(() => data.address, (val) => {\r\n      if (val) {\r\n        data.initContract()\r\n      }\r\n    })\r\n    const refData = toRefs(data);\r\n    return {\r\n      ...refData\r\n    };\r\n  }\r\n}\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.ul {\r\n  margin-bottom: 12px;\r\n  border-radius: 8px;\r\n  background: #fff;\r\n  padding: 16px 13px;\r\n  &:last-child {\r\n    margin-bottom: 0;\r\n  }\r\n  .li {\r\n    display: flex;\r\n    line-height: 1.3;\r\n    padding-bottom: 10.5px;\r\n    div {\r\n      display: inline;\r\n    }\r\n    &:last-child {\r\n      padding-bottom: 0;\r\n    }\r\n\r\n    .key {\r\n      font-size: 14px;\r\n      color: #666;\r\n      flex-shrink: 0;\r\n    }\r\n    .value {\r\n      font-size: 14px;\r\n      color: #111;\r\n      word-break: break-all;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import { render } from \"./List.vue?vue&type=template&id=146008d2&scoped=true\"\nimport script from \"./List.vue?vue&type=script&lang=js\"\nexport * from \"./List.vue?vue&type=script&lang=js\"\n\nimport \"./List.vue?vue&type=style&index=0&id=146008d2&lang=less&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-146008d2\"\n\nexport default script","import { render } from \"./index.vue?vue&type=template&id=d36c7740&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=d36c7740&lang=less&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-d36c7740\"\n\nexport default script","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./List.vue?vue&type=style&index=0&id=146008d2&lang=less&scoped=true\""],"sourceRoot":""}